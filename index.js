var x$;x$=angular.module("core",["ngAnimate"]),x$.directive("delayBk",function(){return{restrict:"A",link:function(e,t,n){var o;return o=n.delayBk,$("<img/>").attr("src",o).load(function(){return $(this).remove(),t.css({"background-image":"url("+o+")"}),t.toggleClass("visible")})}}}),x$.directive("loading",function(){return{restrict:"E",templateUrl:"/loading.html",link:function(){}}}),x$.controller("main",["$scope","$interval","$http"].concat(function(e,t,n){var o,r,a;return e.uid="",e.username="",e.fanpage="",e.isFanpage=!1,e.accessToken="",e.loading=!1,e.wall=[],e.pageId="NtuNewsEForum",e.running=!1,e.finish=!1,FB.init({appId:"1490131354539691",status:!0,cookie:!0,xfbml:!0,oauth:!0}),o=function(){return console.log("get login status..."),e.loading=!0,FB.getLoginStatus(function(t){var o,r,a;return console.log("response..."),"connected"===t.status?(console.log(t),o={userID:(o=t.authResponse).userID,accessToken:o.accessToken},r=o.userID,a=o.accessToken,e.$apply(function(){return e.uid=r,e.accessToken=a,console.log(e.uid)}),n.get("http://graph.facebook.com/"+e.uid+"/profile").success(function(t){return t.data&&t.data[0]?e.username=t.data[0].name:void 0})):console.log("please login"),e.$apply(function(){return e.loading=!1})})},r=function(t){return n.get(t).success(function(t){return console.log(t),e.wall=e.wall.concat(t.data),t.paging&&t.paging.next?setTimeout(function(){return r(t.paging.next)},100):(e.finish=!0,e.running=!1,e.generateDownload())})},e.enlarge=function(e){return e?e.toString().replace(/_s\./,"_n."):void 0},e.setFanpage=function(t){return e.isFanpage=t},e.logout=function(){return e.accessToken?FB.logout(function(){return e.username="",e.accessToken="",e.loading=!1,e.running=!1}):void 0},e.login=function(){return FB.login(function(){return o()},{scope:"read_stream"})},o(),e.startGetWall=function(t,n){var o,a;if(!e.running)return n&&(o=$("#backup-btn").offset().top-200,$("body").scrollTo(o,o,{queue:!0})),t&&(e.isFanpage=!1),e.isFanpage?(a=/https?:\/\/[^\/]+\/([^\/?]+)\??[^\/]*/.exec(e.fanpage),a&&(a=a[1])):a="me",console.log(a),a?(ga("send","event","feed","get",a),e.pageId=a,e.running=!0,e.finish=!1,r("https://graph.facebook.com/"+e.pageId+"/feed?fields=likes.summary(true),id,caption,created_time,description,from,icon,link,message,name,object_id,permalink_url,picture,place,shares,source,story,type,updated_time&limit=50&access_token="+e.accessToken)):void 0},e.generateDownload=function(){var t,n,o,r,a,i,c,s,l,u,p,m,d,g,f,h;t=$("#download-csv"),n=$("#download-json"),o=$("#download-html"),r=e.wall.map(function(e){var t;return e?{name:(e.from||(e.from={})).name||"n/a",message:e.message,likes:((t=e.likes||(e.likes={})).summary||(t.summary={})).total_count||0,shares:(e.shares||(e.shares={})).count||0,link:e.link,type:e.type,created_time:e.created_time,updated_time:e.updated_time,picture:e.picture}:null}).filter(function(e){return e}),i=[];for(c in r[0]||{})i.push(c);return a=i,s=[a.join(",")].concat(r.map(function(e){return a.map(function(t){return'"'+e[t]+'"'}).join(",")})).join("\n"),l=JSON.stringify(e.wall),u='<html><head><meta charset=\'utf-8\'><link rel="stylesheet" type="text/css" href="http://fb.scrape4.me/assets/bootstrap/3.0.2/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="http://fb.scrape4.me/index.css"></head><body>'+$("#posts").html()+"</body></html>",u=u.replace("display:none",""),p=new Blob([s],{type:"text/csv"}),m=new Blob([l],{type:"text/json"}),d=new Blob([u],{type:"text/html"}),g=URL.createObjectURL(p),f=URL.createObjectURL(m),h=URL.createObjectURL(d),t.attr("href",g),n.attr("href",f),o.attr("href",h)},a=['<a href="http://thenounproject.com/term/click/39120/"</a>"Click", Ahmed Trochilidae, BY-CC 3.0','<a href="http://thenounproject.com/term/book/5526/"</a>"Book", Olivier Guin, BY-CC 3.0','<a href="http://thenounproject.com/term/cloud-download/18257/"</a>"Cloud Download", irene hoffman, BY-CC 3.0','<a href="http://thenounproject.com/term/stone-wall/36294/"</a>"Stone Wall", Albert Vila, BY-CC 3.0','<a href="http://thenounproject.com/term/scraper/25913/"</a>"Paint Scraper", factor[e] design initiative, BY-CC 3.0','<a href="http://thenounproject.com/term/star/21280/"</a>"Star", Nick Abrams, BY-CC 3.0'],$("#attribution").popover({placement:"top",html:"true",title:"Attributions to Icons",content:a.join("<br>")}),$("#eula").popover({placement:"top",html:"true",title:"Term of Use",content:"Coming Soon"}),$("#privacy").popover({placement:"top",html:"true",title:"Privacy Policy",content:"Coming Soon"}),$("#about").popover({placement:"top",html:"true",title:"About Us",content:"Coming Soon"})}));